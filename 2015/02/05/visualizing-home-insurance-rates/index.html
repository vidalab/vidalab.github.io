
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Visualizing Home Insurance Rates - Data Visualization Code</title>
  <meta name="author" content="Vida Lab">

  
  <meta name="description" content="Visualizing Home Insurance Rates written Feb 5th, 2015 This tutorial is a guest post from GRIDLEX and vHomeInsurance.com. Visit their websites for &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.vida.io/2015/02/05/visualizing-home-insurance-rates">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Data Visualization Code" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-43778465-5']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

  <body>
    <a href="/" class="home-icon">
      <img src="/images/home.png"/>
    </a>

    <article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h1>Visualizing Home Insurance Rates</h1>
        <div class="meta">
          written 








  



<time datetime="2015-02-05T17:34:11-08:00" pubdate data-updated="true">Feb 5<span>th</span>, 2015</time>
          


        </div>
        <p>This tutorial is a guest post from <a href="http://www.gridlex.com/">GRIDLEX</a> and <a href="http://vHomeInsurance.com">vHomeInsurance.com</a>. Visit their websites for more information.</p>

<p><a href="http://www.gridlex.com/">GRIDLEX</a> is a data analytics firm based in New York.</p>

<p><a href="http://vHomeInsurance.com">vHomeInsurance.com</a>, a home insurance analytics service, visualized US wide home property prices using Vida.io. The below guide walks through a case study on representing geographical data on a map &amp; how they did it.</p>

<p>From the <a href="http://vHomeInsurance.com">vHomeInsurance.com</a> Team:</p>

<p><a href="https://vida.io">Vida.io</a> is a great place on the web to get the visualizations done. Using their templates, some complex map visualizations using D3.js can be done very easily, without much programing knowledge. The beauty of the tool is that only data needs to be plugged in and some styling elements edited, while it handles all the complexities itself.</p>

<p>Here is an example of we used vida.io to generate an awesome Chloropeth heat map representing home prices across the US at a county level.</p>

<p><b>Interactive Heatmap (Hover to See Value)</b></p>

<iframe src="http://embed.vida.io/documents/CvFWfA899K4gtNBtN" width="650" height="420" seamless frameBorder="0" scrolling="no"></iframe>


<p>The above chart from Vida.io is a visualization of home values in all the counties in US quantized to 21 levels, with lighter values representing the counties where homes are cheaper and the darkest are the counties where the homes are the costliest.</p>

<p><b>Search for Your Visualization</b></p>

<p>To generate visualizations like the above heat map:</p>

<ol>
<li>Register and log in</li>
<li>Navigate to Explore section of the page</li>
<li>Click &ldquo;More&rdquo; button of &ldquo;maps&rdquo; category</li>
<li>Select “US Map Counties &ndash; Choropleth”</li>
<li>Clone the document template (clone button is available on the left side just below the map)</li>
</ol>


<p><img src="http://i.imgur.com/1IE8Ewh.png" width="100%"/></p>

<p><b>Get Familiar with the Editing Screen</b></p>

<p>Once the template is cloned, the document is shown in the home screen, click on the document to start editing it. The right half of the editor window has code , data,stylesheets and other configurable variables while the left half has the map itself so that the effect of the changes made can be seen immediately to start editing the document.</p>

<p><img src="http://imgur.com/vffdaVt.png" width="100%"/></p>

<p><b>Import your data</b></p>

<p>We can import data in any one csv, tsv or json format by clicking the import button in the data tab or it can directly be pasted in the editor. If you want to keep things simple keep the headers as is. For example, in the data we imported, we had the county ID  &amp; the home value rates. We can retain those same headers or change it to whatever we want. For example, if we want to change rates to Home Values we need to edit a few extra lines of code.</p>

<p>For the county &amp; geographical information, it has to be noted that the id column in the default data is the combination of state FIPS code and county FIPS code, its important that the data to be visualized contains this number as the its used as the identity of the county when map is generated</p>

<p>More information about the number can be obtained from
<a href="https://www.census.gov/geo/reference/codes/cou.html">https://www.census.gov/geo/reference/codes/cou.html</a></p>

<p><b>Edit Javascript</b></p>

<p>This is where all the magic happens. All the code needed to generate the visualization is already present, we only need to edit one or two lines depending upon what we want to achieve</p>

<p>Notice the following code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">quantize</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">quantize</span><span class="p">()</span>
</span><span class='line'>                  <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="p">.</span><span class="mi">15</span><span class="p">])</span>
</span><span class='line'>                  <span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="mi">9</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;q&quot;</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="s2">&quot;-9&quot;</span><span class="p">;</span> <span class="p">}));</span>
</span></code></pre></td></tr></table></div></figure>


<p>Its of the form:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">quantize</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">quantize</span><span class="p">()</span>
</span><span class='line'>                  <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="o">&lt;</span><span class="nx">LOWEST</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="nx">HIGHEST</span><span class="o">&gt;</span><span class="p">])</span>
</span><span class='line'>                  <span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Q</span><span class="o">&gt;</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;q&quot;</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="s2">&quot;-9&quot;</span><span class="p">;</span> <span class="p">}));</span>
</span></code></pre></td></tr></table></div></figure>


<p>where:</p>

<p><LOWEST> is the lowest value your data can have
<HIGHEST> is the highest value your data can have
<Q> is the number of quantization levels you want for your data, here it is number of colors you want to use in the cloropeth</p>

<p>Change those values according to your data and needs.</p>

<p>If you have changed the headers for data in the data tab see the following code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">data</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">rateById</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="o">+</span><span class="nx">d</span><span class="p">.</span><span class="nx">rate</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Its equivalent to:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">data</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">rateById</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="o">+</span><span class="nx">d</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">Column</span> <span class="nx">Name</span><span class="o">&gt;</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you are comfortable with representing your data in less than 9 colors, just save the document using the save button on the top right and you can see your visualization on the left side of the screen immediately.</p>

<p><b>Change the Colors</b></p>

<p>You can change the colors in the map or other styling in stylesheet tab:</p>

<p>If you have used the default 9 quantization levels its enough to edit the numbers in:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.q0-9</span> <span class="p">{</span> <span class="n">fill</span><span class="o">:</span><span class="k">rgb</span><span class="p">(</span><span class="m">247</span><span class="o">,</span><span class="m">251</span><span class="o">,</span><span class="m">255</span><span class="p">);</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>To change the color of a quantization level 0. you can choose the colors using any online css color picker tool.</p>

<p>If you were not satisfied with 9 quantization levels and increased the number, you need to add the colors you want to use for that quantization level.</p>

<p>For example if you used 11 quantization levels, you need to add the lines:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.q9-9</span> <span class="p">{</span> <span class="n">fill</span><span class="o">:</span><span class="k">rgb</span><span class="p">(</span><span class="m">255</span><span class="o">,</span><span class="m">0</span><span class="o">,</span><span class="m">255</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'><span class="nc">.q10-9</span> <span class="p">{</span> <span class="n">fill</span><span class="o">:</span><span class="k">rgb</span><span class="p">(</span><span class="m">255</span><span class="o">,</span><span class="m">0</span><span class="o">,</span><span class="m">0</span><span class="p">);</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>To use the colors magenta and red to represent the newly added quantization level 9 and 10 respectively.</p>

<p>Save the document to see the visualization.</p>

<p><b>Share your work</b></p>

<p>You can find the code to embed the map in web pages and the link to share your work by clicking the Embed button under Settings tab.</p>

<p>View and clone home insurance visualization here:</p>

<p><a href="https://vida.io/documents/CvFWfA899K4gtNBtN">https://vida.io/documents/CvFWfA899K4gtNBtN</a></p>

        
        <hr class="divider-short"/>
        
        
          <section>
            <h1>Comments</h1>
            <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
          </section>
        
      </div>
    </div>
  </div>
</article>

<hr class="divider-short"/>

<div class="archive-link">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        
          <a class="pull-left" href="/2014/12/20/d3-dot-js-document-template-and-github-integration/" title="Previous Post: D3.js Document Template and GitHub Integration">&laquo; Previous: D3.js Document Template and GitHub Integration</a>
        

        
      </div>
    </div>
  </div>
</div>
    <footer id="footer" class="her-row">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
  <a href="/"><h4>Home</h4></a>
</div>

<div class="col-md-2">
  <div class="social-icon-list">
    
    <a href="https://twitter.com/vidatalk"><img src="/images/glyphicons_social_31_twitter.png"/></a>
    

    

    
  </div>
</div>

<div class="pull-right">
  <h4>Brought to you by <a href="https://vida.io">vida.io</a>. Powered by <a href="http://octopress.org/">Octopress</a>. Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>.</h4>
</div>


    </div>
  </div>
</footer>



<script type="text/javascript">
      var disqus_shortname = 'blogvidaio';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.vida.io/2015/02/05/visualizing-home-insurance-rates/';
        var disqus_url = 'http://blog.vida.io/2015/02/05/visualizing-home-insurance-rates/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


  </body>
</html>
