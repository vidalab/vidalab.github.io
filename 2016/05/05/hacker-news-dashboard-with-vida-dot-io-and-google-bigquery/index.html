
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Hacker News Dashboard With vida.io and Google BigQuery - Data Visualization Code</title>
  <meta name="author" content="Vida Lab">

  
  <meta name="description" content="Hacker News Dashboard With vida.io and Google BigQuery written May 5th, 2016 Google BigQuery provides data storage for large datasets. You can store &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.vida.io/2016/05/05/hacker-news-dashboard-with-vida-dot-io-and-google-bigquery">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Data Visualization Code" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-43778465-5']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

  <body>
    <a href="/" class="home-icon">
      <img src="/images/home.png"/>
    </a>

    <article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h1>Hacker News Dashboard With vida.io and Google BigQuery</h1>
        <div class="meta">
          written 








  



<time datetime="2016-05-05T17:22:36-07:00" pubdate data-updated="true">May 5<span>th</span>, 2016</time>
          


        </div>
        <p>Google BigQuery provides data storage for large datasets. You can store Gigabytes of data and query them in seconds. In this article, we discuss how to connect to Google BigQuery and create a dashboard. We&rsquo;ll use the Hacker News dataset provided in BigQuery public data repository.</p>

<p>The final dashboard has four charts. Here&rsquo;s a screenshot of what it will look like:</p>

<p><img src="http://i.imgur.com/SgRReJU.png" width="100%" title="Final Dashboard" /></p>

<!-- more -->


<p>First, we&rsquo;ll create a data source for Google BigQuery.</p>

<ol>
<li>After login, click on Source tab and New Source button.</li>
<li>Name your source: Hacker News (BigQuery).</li>
<li>Select database type BigQuery.</li>
<li>Upload your credentials file. Click <a href="https://cloud.google.com/storage/docs/authentication#generating-a-private-key">here</a> for instruction to generate the file.</li>
</ol>


<p>Next, we&rsquo;ll create four datasets.</p>

<ol>
<li>Click on Datasets tab and New Dataset button.</li>
<li>Click on Add SQL Query button.</li>
<li>Select the database source we just created: Hacker News (BigQuery).</li>
<li>Paste in the queries below for each dataset.</li>
</ol>


<p>Type Count over Time</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT a.month month, stories, comments, comment_authors, story_authors
</span><span class='line'>FROM (
</span><span class='line'>  SELECT STRFTIME_UTC_USEC(time_ts, '%Y-%m') month, COUNT(*) stories, EXACT_COUNT_DISTINCT(author) story_authors
</span><span class='line'>  FROM [fh-bigquery:hackernews.stories] 
</span><span class='line'>  GROUP BY 1
</span><span class='line'>) a
</span><span class='line'>JOIN (
</span><span class='line'>  SELECT STRFTIME_UTC_USEC(time_ts, '%Y-%m') month, COUNT(*) comments, EXACT_COUNT_DISTINCT(author) comment_authors
</span><span class='line'>  FROM [fh-bigquery:hackernews.comments] 
</span><span class='line'>  GROUP BY 1
</span><span class='line'>) b
</span><span class='line'>ON a.month=b.month
</span><span class='line'>ORDER BY 1</span></code></pre></td></tr></table></div></figure>


<p>Type Count Summary</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT type, COUNT(*) count
</span><span class='line'>FROM [fh-bigquery:hackernews.full_201510]
</span><span class='line'>GROUP BY 1
</span><span class='line'>ORDER BY 2
</span><span class='line'>LIMIT 100</span></code></pre></td></tr></table></div></figure>


<p>Number of Comments during Day</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT HOUR(SEC_TO_TIMESTAMP(time-3600*7)) hour, COUNT(*) comments, AVG(ranking) avg_ranking, SUM(ranking=0)/COUNT(*) prob
</span><span class='line'>FROM [fh-bigquery:hackernews.comments] 
</span><span class='line'>WHERE YEAR(time_ts)=2015
</span><span class='line'>GROUP BY 1
</span><span class='line'>ORDER BY 1</span></code></pre></td></tr></table></div></figure>


<p>Probability of Having Top Comments</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT HOUR(SEC_TO_TIMESTAMP(time-3600*7)) hour, COUNT(*) comments, AVG(ranking) avg_ranking, SUM(ranking=0)/COUNT(*) prob
</span><span class='line'>FROM [fh-bigquery:hackernews.comments] 
</span><span class='line'>WHERE YEAR(time_ts)=2015
</span><span class='line'>AND parent IN (SELECT id FROM [fh-bigquery:hackernews.stories] WHERE score&gt;10)
</span><span class='line'>GROUP BY 1
</span><span class='line'>ORDER BY 1</span></code></pre></td></tr></table></div></figure>


<p>Here are the links to the 4 datasets that we use:</p>

<ul>
<li><a href="https://vida.io/datasets/DvPDG5HfxpDNkEMQ3">Hacker News &ndash; Type Count over Time</a></li>
<li><a href="https://vida.io/datasets/TGc5ytt99pQnLP9Gg">Hacker News &ndash; Type Count Summary</a></li>
<li><a href="https://vida.io/datasets/hNN5Hmf762NYuyYQQ">Hacker News &ndash; Number of Comments during Day</a></li>
<li><a href="https://vida.io/datasets/Qzicd7DFjy5mKTbL2">Hacker News &ndash; Probability of Having Top Comments</a></li>
</ul>


<p>After creating 4 datasets, we go to Dashboards tab and create new dashboard. We&rsquo;ll add 1 line chart and 3 bar charts.</p>

<ul>
<li><p>Line Chart &ndash; Type Count over Time</p>

<ol>
<li>Select dataset &ldquo;Hacker News &ndash; Type Count over Time&rdquo;.</li>
<li>Set X Axis to Month.</li>
<li>Set X Axis Label to Month.</li>
<li>Set Y Axis Label to Count.</li>
<li>Set Y Axis to: stories[new line]comments[new line]comment authors[new line]story_authors.</li>
<li>Set Title to: Type Count over Time.</li>
</ol>
</li>
<li><p>Bar Chart &ndash; Type Count Summary</p>

<ol>
<li>Select dataset &ldquo;Hacker News &ndash; Type Count Summary&rdquo;.</li>
<li>Set X Axis to Type.</li>
<li>Set X Axis Label to Type.</li>
<li>Set Y Axis Label to Count.</li>
<li>Set Y Axis to count.</li>
<li>Set Title to: Type Count Summary.</li>
</ol>
</li>
<li><p>Bar Chart &ndash; Number of Comments during Day</p>

<ol>
<li>Select dataset &ldquo;Hacker News &ndash; Number of Comments during Day&rdquo;.</li>
<li>Set X Axis to Hour.</li>
<li>Set X Axis Label to Hour.</li>
<li>Set Y Axis Label to Count.</li>
<li>Set Y Axis to count.</li>
<li>Set Title to: Number of Comments during Day.</li>
</ol>
</li>
<li><p>Bar Chart &ndash; Probability of Having Top Comments</p>

<ol>
<li>Select dataset &ldquo;Hacker News &ndash; Probability of Having Top Comments&rdquo;</li>
<li>Set X Axis to Hour.</li>
<li>Set X Axis Label to Hour.</li>
<li>Set Y Axis Label to Probability.</li>
<li>Set Y Axis to prob.</li>
<li>Set Title to: Probability of Having Top Comments.</li>
</ol>
</li>
</ul>


<p>Here&rsquo;s a video demo of the entire process:</p>

<iframe width="630" height="472" src="//www.youtube.com/embed/BGfTa_wKjK4" frameborder="0" allowfullscreen></iframe>


        
        <hr class="divider-short"/>
        
        
          <section>
            <h1>Comments</h1>
            <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
          </section>
        
      </div>
    </div>
  </div>
</article>

<hr class="divider-short"/>

<div class="archive-link">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        
          <a class="pull-left" href="/2015/11/02/using-google-spreadsheet-data-in-d3-dot-js-visualizations/" title="Previous Post: Using Google Spreadsheet data in d3.js visualizations">&laquo; Previous: Using Google Spreadsheet data in d3.js visualizations</a>
        

        
          <a class="pull-right" href="/2016/11/06/connect-d3-dot-js-visualization-with-sql-database/" title="Next Post: Connect D3.js Visualization with SQL database">Next: Connect D3.js Visualization with SQL database &raquo;</a>
        
      </div>
    </div>
  </div>
</div>
    <footer id="footer" class="her-row">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
  <a href="/"><h4>Home</h4></a>
</div>

<div class="col-md-2">
  <div class="social-icon-list">
    
    <a href="https://twitter.com/vidatalk"><img src="/images/glyphicons_social_31_twitter.png"/></a>
    

    

    
  </div>
</div>

<div class="pull-right">
  <h4>Brought to you by <a href="https://vida.io">vida.io</a>. Powered by <a href="http://octopress.org/">Octopress</a>. Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>.</h4>
</div>


    </div>
  </div>
</footer>



<script type="text/javascript">
      var disqus_shortname = 'blogvidaio';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.vida.io/2016/05/05/hacker-news-dashboard-with-vida-dot-io-and-google-bigquery/';
        var disqus_url = 'http://blog.vida.io/2016/05/05/hacker-news-dashboard-with-vida-dot-io-and-google-bigquery/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


  </body>
</html>
